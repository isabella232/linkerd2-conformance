#!/bin/sh

set -eu

if [ $# -ne 2 ]; then
    echo "Usage: bin/${0##*/} [Username] [test|base|sonobuoy]" >&2
    exit 1
fi

cmd="docker build"
case $2 in
    "test")
        $cmd -t "$1"/linkerd2-conformance .
        ;;
    "base")
        $cmd -t "$1"/linkerd2-conformance-base -f sonobuoy/base.Dockerfile .
        ;;
    "sonobuoy")
        $cmd -t "$1"/linkerd2-sonobuoy -f sonobuoy/sonobuoy.Dockerfile .
        ;;
    *)
        echo "Invalid option for source: $2"
        exit 1 
        ;;
esac

